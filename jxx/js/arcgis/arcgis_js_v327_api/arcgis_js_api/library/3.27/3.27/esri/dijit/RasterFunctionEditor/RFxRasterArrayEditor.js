// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.27/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/RasterFunctionEditor/templates/RFxRasterArrayEditor.html":'\x3cdiv class\x3d"esriRFxRasterArrayEditor"\x3e\r\n  \x3ctable class\x3d"esriRFxArgsEditor__table"\x3e\r\n    \x3ccol width\x3d"auto"\x3e\r\n    \x3ccol class\x3d"esriRFxRasterArrayEditor__td--btn"\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3cdiv data-dojo-type\x3d"esri/dijit/RasterFunctionEditor/RFxRasterInput" data-dojo-attach-point\x3d"_layerSelect"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd rowspan\x3d"3" class\x3d"esriRFxRasterArrayEditor__td--grid"\x3e\r\n        \x3cdiv class\x3d"esriRFxRasterArrayEditor__grid" data-dojo-attach-point\x3d"_gridNode"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"esriActionButton esriRFxRasterArrayEditor__btn" data-dojo-attach-event\x3d"onClick: _onUpButtonClick" data-dojo-props\x3d"iconClass: \'iconMoveUp\'"\r\n        data-dojo-attach-point\x3d"_moveUpButton" title\x3d"${_i18n.rfxRasterArrayEditor.moveUp}"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"esriActionButton esriRFxRasterArrayEditor__btn" data-dojo-attach-event\x3d"onClick: _onDownButtonClick" data-dojo-props\x3d"iconClass: \'iconMoveDown\'"\r\n        data-dojo-attach-point\x3d"_moveDownButton" title\x3d"${_i18n.rfxRasterArrayEditor.moveDown}"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"esriActionButton esriRFxRasterArrayEditor__btn" data-dojo-attach-event\x3d"onClick: _onRemoveButtonClick" data-dojo-props\x3d"iconClass:\'esriAnalysisDeleteIcon\'"\r\n        data-dojo-attach-point\x3d"_removeButton" title\x3d"${_i18n.rfxRasterArrayEditor.remove}"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e'}});
define("esri/dijit/RasterFunctionEditor/RFxRasterArrayEditor","dojo/_base/declare dojo/has ../../kernel dojo/_base/lang dojo/_base/array dojo/store/Memory dojo/store/Observable dojo/data/ObjectStore dijit/form/Select dijit/form/Button dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dgrid/OnDemandGrid dgrid/Selection ./utils dojo/text!./templates/RFxRasterArrayEditor.html dojo/i18n!../../nls/jsapi".split(" "),function(k,n,p,l,f,m,q,r,h,A,t,u,v,w,x,g,y,z){h=k("RFxRasterArrayEditor",
[t,u,v],{templateString:y,inputLayers:null,value:[],_lastId:1,constructor:function(a){this.inherited(arguments);this._i18n=z.widgets.rasterFunctionEditor},postCreate:function(){this.inherited(arguments);this._populateLayerSelect();this._setupGrid();this._readValues()},_getValueAttr:function(){this._updateValue();return this.value},_getInputLayersStore:function(){return new r(new m({data:this.inputLayers}))},_populateLayerSelect:function(){this._layerSelect.set("browseProperties",this.browseProperties);
this._layerSelect.set("selectDefault",!1);this._layerSelect.set("allowScalar",this.allowScalar);this._layerSelect.set("inputLayers",this.inputLayers);this.own(this._layerSelect.on("change",l.hitch(this,this._addLayer)))},_setupGrid:function(){this._layerStore=q(new m);this._layerGrid=new (k([w,x]))({selectionMode:"single",showHeader:!1,store:this._layerStore,allowSelect:function(a){return!(a.data&&a.data.isTemplate)},queryOptions:{sort:[{attribute:"id"}]},columns:[{field:"name"}]},this._gridNode)},
_readValues:function(){if(this.value&&(this.value.elements||Array.isArray(this.value))){var a=this._layerStore,b=0,c,d;f.forEach(this.value.elements||this.value,function(e){c=e&&e.type===g.RFX_VARIABLE_TYPE?e.value:e;d=e.type;if(d===g.RFX_TEMPLATE_TYPE)return a.put(this._getRFTGridData(e,++b));if(c&&c.type===g.RFX_TEMPLATE_TYPE)return a.put(this._getRFTGridData(c,++b));(d===g.RFX_VARIABLE_TYPE||e.url)&&(e=this._getRFVGridData(c,++b))&&a.put(e)},this);this._layerGrid.refresh()}},_getRFVGridData:function(a,
b){if(a){var c=g.getLayerIdfromRasterValue(a,this.inputLayers),d;if(a&&a.type&&"scalar"===a.type.toLowerCase())return{id:b,name:String(a.value),value:a,isTemplate:!1};if(c&&(f.some(this.inputLayers,function(a){if(c===a.id)return d=a,!0}),d))return{id:b,name:d.name,value:a,isTemplate:!1}}},_getRFTGridData:function(a,b){if(a)return{id:b,name:"\x3c"+a["function"].name+"."+this._i18n.rfxArgsEditor.outputRaster+"\x3e",value:a,isTemplate:!0}},_addLayer:function(){this._adjustGridItemIds();var a=this._layerSelect.get("value"),
b=this._layerStore.data.length;a&&(a={id:b+1,value:a,name:a.name||a.value},this._layerStore.put(a),this._refreshGrid())},_onRemoveButtonClick:function(){var a=this._getSelectedId();this._layerStore.remove(a);this._refreshGrid()},_adjustGridItemIds:function(){var a=this._layerStore&&this._layerStore.data;a&&(f.map(a,function(a,c){a.id=c+1;return a}),this._layerStore.setData(a))},_onUpButtonClick:function(){var a=this._getSelectedItem();if(this._layerStore&&this._layerStore.data&&a){var b,c=this._layerStore.data,
d=f.indexOf(c,a);0>=d||(b=c[d-1],c[d-1]=a,c[d]=b,this._refreshGrid())}},_onDownButtonClick:function(){var a=this._getSelectedItem();if(this._layerStore&&this._layerStore.data&&a){var b=this._layerStore.data,c=f.indexOf(b,a);c!==b.length-1&&(b[c]=b[c+1],b[c+1]=a,this._refreshGrid())}},_getSelectedId:function(){return Object.keys(this._layerGrid&&this._layerGrid.selection)[0]},_getSelectedItem:function(){var a=this._getSelectedId();return this._layerStore.get(a)},_refreshGrid:function(){this._adjustGridItemIds();
this._updateValue();this._layerGrid.refresh()},_updateValue:function(){var a=this._layerStore&&this._layerStore.data,b=[];a&&(f.forEach(a,function(a){a.isTemplate?b.push(this.getRFT?this.getRFT(a.value):a.value):b.push(a.value)},this),this.value=b)}});n("extend-esri")&&l.setObject("dijit.RasterFunctionEditor.RFxNamedRasterEditor",h,p);return h});