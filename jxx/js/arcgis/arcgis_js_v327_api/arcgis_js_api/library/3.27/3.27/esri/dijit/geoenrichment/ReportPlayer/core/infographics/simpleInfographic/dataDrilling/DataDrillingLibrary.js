// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.27/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/simpleInfographic/dataDrilling/DataDrillingLibrary","dojo/_base/lang ./_FieldInfoBuilder ../../../supportClasses/tableJson/TableJsonUtil ../../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil ./_config ./EnrichUtil".split(" "),function(k,p,q,r,g,l){function n(a){return"string"===typeof a?a.split(",").map(function(a){return a+"/"}):a}var b={};l.ddLibrary=b;b.getDrillingOptions=function(a,e,f){if(e){var c=function(){function c(a,
c){return h&&-1!==h.indexOf(a)?!0:b&&b.some(function(b){return-1!==b.indexOf(a)||-1!==b.indexOf(c)})}if("string"===typeof e){var d=g.getById(a+"."+e);return d?[d]:null}var b=e.usedFields||f&&f(e),b=b&&b.map(function(a){return a.toUpperCase()});if(!e.variableID&&!b)return null;var h=e.variableID&&e.variableID.toUpperCase(),d=g.LIBRARY[a],m;for(m in d){var k=m.toUpperCase(),l=r.createFieldNameFromVariable(m).toUpperCase();if(c(k,l))return d[m]}return null}();c&&c.forEach(function(a){b._provideStateData(a)});
return c}};b.getDrillingOptionByStandardId=function(a,b){};b.getDrillingOptionInfo=function(a,e,f,c,t,d,g){a=(a=b.getDrillingOptions(a,e,g))&&a.filter(function(a){return a.name===f})[0];if(!a)return null;!d&&a.defaultState&&(d=a.defaultState);d=d&&d.charAt(0)||"n";var h;a.calcGroup&&(h=k.clone(a.calcGroup),h.value=d+"/");c=q.createSingleCellTable({fieldInfo:a.stateData[d].fieldInfo,width:c,height:t});return{calculationStatesGroup:h,tableJson:k.clone(c),enrichInfos:l._getStandardEnrichInfosForTableInfo(a,
!0)}};b._provideStateData=function(a){if(!a.stateData){a.stateData={n:{fieldInfo:a.fieldInfo}};a.states&&(a.states=n(a.states),a.states.forEach(function(c){c=c.charAt(0);if("n"!==c){var b=k.clone(a.fieldInfo);a.stateData[c]={fieldInfo:b};if(b.isChart){b.chartJson.visualProperties.title.text+=" ("+g.STATE_LOCALIZATION_MAP_SHORT[c]+")";b.chartJson.visualProperties.yAxis.title=g.STATE_LOCALIZATION_MAP[c];var d=a.dataLabelsDecimals&&a.dataLabelsDecimals[c];if(void 0!==d)b.chartJson.visualProperties.dataLabelsDecimals=
d;else{if("p"===c||"a"===c)b.chartJson.visualProperties.dataLabelsDecimals=1;"i"===c&&(b.chartJson.visualProperties.dataLabelsDecimals=0)}}}}),a.calcGroup=b.createCalculationStatesGroup(a.states),delete a.states,delete a.dataLabelsDecimals);for(var e in a.stateData){var f=a.stateData[e];f.fieldInfo.isChart&&f.fieldInfo.chartJson.seriesItems.forEach(function(a){a.points.forEach(function(b){p.provideFieldInfoForChartPoint(b,a,1===f.fieldInfo.chartJson.seriesItems.length,e,f.fieldInfo.chartJson.comparisonInfo&&
f.fieldInfo.chartJson.comparisonInfo.calculatorName)})})}delete a.fieldInfo}};b.createCalculationStatesGroup=function(a){if(a)return a=n(a),{states:{ids:a,names:a.slice(),labels:a.map(function(a){return g.STATE_LOCALIZATION_MAP_SHORT[a.charAt(0)]})},value:a[0]}};return b});