// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.27/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/builder/round/_GaugeChartSeriesCalculator","../../ThemeCalculator ../../ChartTypes ../../../../supportClasses/conditionalStyling/ConditionalStyleUtil ../../../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder ../utils/ChartDataUtil ../utils/TooltipInfoBuilder ../utils/ChartDataLabelBuilder dojo/i18n!esri/nls/jsapi".split(" "),function(z,r,t,A,u,B,C,g){g=g.geoenrichment.dijit.ReportPlayer.ChartContainer;return{calcSeries:function(b){var v=
b.seriesItems,h=b.chartType,D=b.themeSettings,E=b.viewModel,c=b.visualProperties,F=b.currentFeatureIndex;b=[];var l=v[0],w={name:"data",data:[]},k=[],m=0,n=0,p=1E6,q=-1E6,x,a=l.points;1===a.length&&(a=a.slice(),a.push({label:g.gaugeOthers}));if(r.isConditionalStylingEnabled(h)&&c.conditionalStyling){var y=t.getStatistics(c.conditionalStyling);y&&l&&(x=u.getChartData(y,a.length))}var G=A.isFieldInfoInPercentState(a[0].fieldInfo);a.forEach(function(e,a){var d;0===a?d=u.getPointValue({point:e,index:0,
seriesIndex:0,maxValue:!1,chartType:h,visualProperties:c,viewModel:E,currentFeatureIndex:F,chartData:x}):1===a&&(e=k[0],d=c.gaugeRangeMax?Math.max(0,c.gaugeRangeMax-e):G?Math.max(0,100-e):0);d=(k[a]=d)||0;m+=d;n+=Math.abs(d);p=Math.min(p,d);q=Math.max(q,d)});0===k[1]&&(a.length=1);var H=m/a.length;a.forEach(function(a,b){var d=k[b],e=d||0,f;r.isConditionalStylingEnabled(h)&&c.conditionalStyling&&(f=(f=t.getConditionalStyle(e,c.conditionalStyling))&&f.backgroundColor,1===b&&c.gaugeConditionalStylingIgnoreOthers&&
(f=void 0));f=f||z.calcColorForPoint({point:a,seriesItem:l,pointIndex:b,seriesIndex:0,numSeries:v.length,chartType:h,themeSettings:D});var g=e;0===b&&c.gaugeRangeMin&&(g=Math.max(0,g-c.gaugeRangeMin));w.data.push({originalValue:d,x:1,y:Math.max(1E-4,g),isUnavailableData:isNaN(d),valueProp:"y",unsortedIndex:b,name:a.label,point:a,fill:f,text:C.formatDataLabel(e,a.label,n,c,h),tooltip:B.getTooltipInfo({yValue:e,pointLabel:a.label,seriesLabel:null,minInSeriesValue:p,maxInSeriesValue:q,sumInSeriesValue:m,
absSumInSeriesValue:n,avgInSeriesValue:H,visualProperties:c,chartType:h,color:f,conditionalStyling:c.conditionalStyling,fieldInfo:a.fieldInfo,decimals:a.value&&a.value.decimals}),stroke:{width:0}})});b.push(w);return b}}});