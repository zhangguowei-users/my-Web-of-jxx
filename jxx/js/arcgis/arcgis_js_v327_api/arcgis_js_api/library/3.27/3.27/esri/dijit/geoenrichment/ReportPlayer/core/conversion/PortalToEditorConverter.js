// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.27/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/conversion/PortalToEditorConverter","dojo/when ./portalToEditorUtils/layout/LayoutParser ./portalToEditorUtils/metadata/MetadataParser ./portalToEditorUtils/ImageCollector ./portalToEditorUtils/parsers/Parsers ../supportClasses/DefaultStyles ../supportClasses/images/ImageDataHolder ../themes/conversion/CssParser esri/dijit/geoenrichment/utils/async/AsyncQueue esri/dijit/geoenrichment/utils/DelayUtil".split(" "),function(e,u,v,w,m,x,n,y,z,A){return{provideEditorJson:function(g,
a){function B(){function f(b,p,c){return e(a.preProcessFile&&a.preProcessFile(b,p,d),function(f){if(!1!==f)return e(c&&c(),function(){return a.postProcessFile&&a.postProcessFile(b,p,d)})})}if(h&&h.files&&h.files){var g=a.filesToProcess||["theme.css.txt","metadata.xml","report.xml"],r={"theme.css.txt":function(b){return f(b,"theme.css.txt",function(){d.theme=y.fromCssText(b.data,a)})},"metadata.xml":function(b){return f(b,"metadata.xml",function(){return v.parseMetadataXML(b,d,a)})},"report.xml":function(b){return f(b,
"report.xml",function(){return u.parseReportXML({isGraphicReport:q,parsers:m,file:b,templateJson:d,variableProvider:a.variableProvider,userVariableProviderToCollectOnly:a.userVariableProviderToCollectOnly,tableDefaultStyles:C,processFileName:l,putImageData:function(a,c){a=l(a);c=c||k[a];n.putImageData(a,c);return c},log:D,queryMetaDataFunc:function(b){return a.queryMetaDataFunc&&a.queryMetaDataFunc(b,d)},postProcessChartJson:function(b,c){a.postProcessChartJson&&a.postProcessChartJson(d,b,c)},postProcessImageJson:function(b,
c){a.postProcessImageJson&&a.postProcessImageJson(d,b,c)},postProcessInfographicJson:function(b,c){a.postProcessInfographicJson&&a.postProcessInfographicJson(d,b,c)},postProcessTableInSection:function(b,c){a.postProcessTableInSection&&a.postProcessTableInSection(d,b,c)}})})},generic:function(a,d){return f(a,d)}},t=new z;g.forEach(function(a){var b=h.files.filter(function(b){return b.name===a})[0],c=b&&(r[a]||r.generic);c&&t.add(function(){return e(A.delay(50),function(){return c(b,a)}).otherwise(function(a){d.metadata.parseErrors.push(a);
console.log(a)})})});return t.getPromise()}}a=a||{};var q=g.isGraphicReport,C=a.tableDefaultStyles||new x,d={documentOptions:{},metadata:{parseErrors:[],mapImageInfosHash:{},comparisonCalculatorsHash:{},locatorCalculatorsHash:{}},theme:null};q?d.sectionsTables=[]:d.sections=[];var h=g.portalJson,k={};a.getImageData=function(a){return k[l(a)]};var l=function(a){return a?a.toLowerCase():""},D=a.log||function(a){};return e(m.initialize(),function(){return e(w.collectImageResources(h,k,l),function(){for(var a in k)n.putImageData(a,
k[a]);return e(B(),function(){d.metadata.parseErrors.length||(g.templateJson=d);delete d.metadata})})})}}});