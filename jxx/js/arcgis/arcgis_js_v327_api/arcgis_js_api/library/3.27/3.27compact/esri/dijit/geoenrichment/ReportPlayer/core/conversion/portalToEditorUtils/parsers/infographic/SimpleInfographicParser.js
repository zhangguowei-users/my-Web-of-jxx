// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.27/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/parsers/infographic/SimpleInfographicParser","dojo/_base/lang ../../../ConversionUtil esri/dijit/geoenrichment/ReportPlayer/core/infographics/utils/InfographicJsonUtil esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder dojo/i18n!esri/nls/jsapi".split(" "),function(v,k,t,c,w,l){l=l.geoenrichment.dijit.ReportPlayer.ReportPlayer;
return{portalToEditor:function(b,e){function m(a){return e.parsers.getParser("section").parseTable(a,e)}var u=b.tags.slice(),n,p=[],q,r;(function(){1.1<=e.revisionVersion?u.forEach(function(a){switch(a.attributes.type){case c.INFOGRAPHIC_HEADER:n=a.tags[0];break;case c.INFOGRAPHIC_VARIABLE:p.push(a);break;case c.INFOGRAPHIC_BACKGROUND:q=a.tags;break;case c.INFOGRAPHIC_FOREGROUND:r=a.tags}}):p=u.filter(function(a){return"infographicHeader"===a.attributes.type?(n=a,!1):!0})})();var d={type:b.attributes.type,
isDefault:b.attributes.isDefault,style:{width:k.ptToPx(b.attributes.width),height:k.ptToPx(b.attributes.height),backgroundColor:b.attributes.backgroundColor},background:q?q.map(m):null,header:n&&m(n),variableTables:null,foreground:r?r.map(m):null,dataDrilling:null};d.variableTables=p.map(function(a){var b={style:k.ptToPxObj({left:a.attributes.left,top:a.attributes.top,width:a.attributes.width,height:a.attributes.height})},g;a.tags.forEach(function(a){if("dataDrillingPanels"===a.name)g=a;else{var c=
a.attributes.type,d=m(a),f=d.data.data[0],h=d.data.columns[0].field;a={isContrastColor:a.attributes.isContrastColor,isHighlighted:a.attributes.isHighlighted,style:v.mixin({width:d.data.columns[0].style.width,height:f.style.height,left:d.style.left,top:d.style.spaceBefore},f.style.fields[h])};delete a.style.overrideStyle;"shape"===c&&(a.shapeJson=f.fieldInfos[h].shapeJson,1.6>e.revisionVersion&&(a.style.width-=3,a.style.height-=3,a.shapeJson.style.width-=3,a.shapeJson.style.height-=3));"image"===c?
a.imageJson=f.fieldInfos[h].imageJson:"variable"===c?a.fieldInfo=f.fieldInfos[h]||w.createFieldInfoFromMissingVariable():"description"===c&&(a.text=f[h]);b[c]=a}});if((a=b.variable&&b.variable.fieldInfo)&&a.isMissing){a.alias=b.description&&b.description.text;if(!a.alias&&e.variableProvider.isPlayerOnly){var c=e.variableProvider.toCalculator(a.templateName);a.alias=c&&c.variable.alias}a.alias=a.alias?a.alias+" ("+l.missingVariable+")":l.missingVariable}g&&g.tags&&g.tags.length&&(a=g.tags[0],a.attributes&&
a.attributes.isStandard?t.setDataDrilling(d,b.variable.fieldInfo.templateName,{isStandard:!0,standardId:a.attributes.standardId}):(a=a.tags&&a.tags[0])&&"section"===a.name&&t.setDataDrilling(d,b.variable.fieldInfo.templateName,{sectionJson:e.parsers.getParser("section").parseSection(a,e)}));return b});["padding"].forEach(function(a){void 0!==b.attributes[a]&&(d.style[a]=k.ptToPx(b.attributes[a]))});return d}}});