// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.27/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/printing/_PrintSettingsSupport","dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/when esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions esri/dijit/geoenrichment/ReportPlayer/PlayerCommands ./HeaderFooterSettingsBuilder".split(" "),function(p,m,n,e,q,k,r){return p(null,{_checkPrintSettings:function(a){function f(){return b.getAllReportContainers().some(function(a){return a.hasHiddenContent()})}function h(){return m.mixin({commandId:a.commandId,
needAutoScale:f(),pageSettings:b.getCurrentReportContainer().documentOptions,addHeader:!1,addDataSource:!1,addFooter:!1,reportTitle:void 0,reportSubtitle:void 0,allowDataDrilling:!0},a.printSettings)}function c(){e(b._player.dataProvider.getCommands(),function(c){c={canAutoScale:f(),currentPageSettings:b.getCurrentReportContainer().documentOptions,commandId:a.commandId,reportTitle:b._player.getReportTitle(),reportSubtitle:b._player.printConfig.subtitle,exportCommands:a.commandId===k.PRINT?null:c.filter(function(a){return a.id!==
k.PRINT})};var l=new b._player.printConfig.printDialogClass;l.onPrint=function(a){e(b._applyPrintSettings(m.mixin(h(),a)),d.resolve,d.reject)};l.onCancel=function(){d.resolve("cancel")};l.show(c)})}var b=this,d=new n;a.showDialog?c():e(b._applyPrintSettings(h()),d.resolve,d.reject);return d.promise},_applyPrintSettings:function(a){function f(){c.getAllReportContainers().forEach(function(a){a.resizeRowHeightToShowCellsContent()});var a=new n;setTimeout(a.resolve,500);return a.promise}function h(){return e(r.createHeaderFooterParams(c._player,
c._viewModel,a),function(a){c._headerFooterParams=a})}var c=this;this._commandId=a.commandId||this._commandId;this._allowDataDrilling=a.allowDataDrilling;var b=a.commandId!==k.DYNAMIC_HTML&&a.needAutoScale,d,g;b&&(d=this.getCurrentReportContainer().toJson());g=this._player._showAllContainers();this._pageSettingsRollBackFunc=function(){g&&g.undo();g=null;if(b)return c._player.updateTemplateJson(d),c._player.refresh({rerenderContent:!0})};return e(b&&f(),function(){c._pageSettings=a.pageSettings;var b=
q.getPageBox(a.pageSettings);c._pageFitParams={w:b.w,h:b.h,hAlign:"center",vAlign:"top"};return h()})}})});