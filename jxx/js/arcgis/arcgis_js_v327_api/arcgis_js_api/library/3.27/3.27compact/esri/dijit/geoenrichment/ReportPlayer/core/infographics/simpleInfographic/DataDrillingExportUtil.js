// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.27/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/simpleInfographic/DataDrillingExportUtil","dojo/_base/lang dojo/when dojo/dom-construct esri/dijit/geoenrichment/ReportPlayer/ReportPlayer esri/dijit/geoenrichment/ReportPlayer/PlayerResizeModes esri/dijit/geoenrichment/ReportPlayer/PlayerThemes esri/dijit/geoenrichment/ReportPlayer/DataProviderGE esri/dijit/geoenrichment/ReportPlayer/PlayerCommands ../../reportContainerGrid/utils/PageQueryUtil ../../supportClasses/templateJsonUtils/BlankTemplateJsonUtil ../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/WaitingUtil".split(" "),
function(p,k,f,q,r,t,u,c,l,v,w,h,n){var d={reportPlayerClass:q,dataProviderClass:u,initPlayer:function(){var a=f.create("div",{"class":"esriGEAbsoluteStretched esriGEOffscreen"},document.body),b=new d.dataProviderClass;b.registerCommand(c.PRINT);b.registerCommand(c.IMAGE);b=(new d.reportPlayerClass({theme:t.DARK,dataProvider:b,resizeMode:r.FIT_WINDOW,isDataDrillingPlayer:!0})).placeAt(a);b.__playerDiv=a;return b},destroyPlayer:function(a){a.destroy();f.destroy(a.__playerDiv)}},b={},m=!1;b.setReportPlayerClass=
function(a){d.reportPlayerClass=a};b.setDataProviderClass=function(a){d.dataProviderClass=a};b.canPrintDataDrilling=function(a){return h.isMobileDevice()?!1:!!l.getParentReportPlayer(a).dataProvider.getCommandById(c.PRINT)};b.canExportDataDrilling=function(a){return h.isMobileDevice()?!1:(a=l.getParentReportPlayer(a).dataProvider.getCommandById(c.IMAGE))&&a.isBrowserSupported()};b.printDataDrilling=function(a){b._createTemporaryPlayerAndExport(a,!0)};b.exportDataDrilling=function(a){b._createTemporaryPlayerAndExport(a,
!1)};b._createTemporaryPlayerAndExport=function(a,c){if(!m){m=!0;var f,g=l.getParentReportPlayer(a),h=g.getReportData(),g=g.dataProvider.reportDataToSingleAreaReportData(h,{currentFeatureIndex:a.currentFeatureIndex||0,reportTitle:g.getReportTitle(),templateJson:function(){var b=a._getDataDrillingPanelDimensions(),b=v.createBlankTemplate({elementWidth:b.w,elementHeight:b.h,layout:{numRows:1,numColumns:1}});b.theme=p.clone(a.theme);delete b.theme.document.backgroundImage;f=a._drillingSections[0].getVisualState();
var c=a._drillingSections[0].toJson(),c=w.createFieldInfoFromSection(c),d=b.sectionsTables[0].data;d.data[0].fieldInfos[d.columns[0].field]=c;return b}()}),e=d.initPlayer();e.onCommandSettingsShown=function(c){n.showProgressPromise(a.dataDrillingViewDiv,c);b.unitTesting_onCommandSettingsShown()};e.onCommandStart=function(b){n.showProgressPromise(a.dataDrillingViewDiv,b)};k(e.setReportData(g,{waitUntilAllContentIsReady:!0,disableAnimation:!0}),function(){var a={pages:[{grid:{cells:[f]}}]};return k(e.getCurrentReportContainer().setVisualState(a),
function(){return k(e[c?"executePrint":"executeExport"](),function(a){d.destroyPlayer(e);b.unitTesting_onExportCommandFinished(a)})})}).always(function(){m=!1})}};b.unitTesting_onCommandSettingsShown=function(){};b.unitTesting_onExportCommandFinished=function(a){};return b});