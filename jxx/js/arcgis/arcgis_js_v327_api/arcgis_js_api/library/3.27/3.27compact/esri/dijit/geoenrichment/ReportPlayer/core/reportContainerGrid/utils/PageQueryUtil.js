// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.27/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/reportContainerGrid/utils/PageQueryUtil",["dojo/dom-geometry","../ReportContainerGrid","../../../ReportPlayer","esri/dijit/geoenrichment/utils/ColorUtil","esri/dijit/geoenrichment/utils/DomUtil"],function(r,u,x,z,t){var v={getElementPageInfo:function(a){function d(a,g){a=r.position(a.domNode);g=r.position(g.domNode);c.x+=a.x-g.x;c.y+=a.y-g.y}function h(a){p||(a=a.getFullStyle().backgroundColor)&&!z.isTransparent(a)&&(p=a)}function f(b){if(b){b.parentGridCell&&
h(b.parentGridCell);var n=b.parentWidget;if(n)if(n instanceof u){if(e=n,b=v.getNodePositionOnPage(e,b.domNode))c.x+=b.x,c.y+=b.y,m=b.pageGrid,k=b.gridContainer,l=b.pageIndex,b=v.getNodePositionOnPage(e,a.domNode),q=b.layoutCell,w=b.isBackgroundFloatingPanel,g=b.isForegroundFloatingPanel,y=b.panelIndex}else d(b,n),f(n);else b.parentElementInPageInfo&&(e=b.parentElementInPageInfo.reportContainer,p=p||b.parentElementInPageInfo.panelBackgroundColor,c.x+=b.parentElementInPageInfo.pos.x,c.y+=b.parentElementInPageInfo.pos.y)}}
if(a&&(a.parentWidget||a.parentGrid)){var e,c={x:0,y:0},m,k,l,q,p,w,g,y;a.parentGrid&&a.rowId&&a.columnId?(h(a),d(a,a.parentGrid),f(a.parentGrid)):f(a);return e?{reportContainer:e,documentOptions:e.documentOptions,pos:c,zoom:e.getZoomInfo().scale,pageGrid:m,gridContainer:k,pageIndex:l,layoutCell:q,panelBackgroundColor:p,isFloatingPanel:w||g,isBackgroundFloatingPanel:w,isForegroundFloatingPanel:g,panelIndex:y}:null}},getReportContainerPageNode:function(a){for(;a;){if(a.reportContainerPageNode)return a.reportContainerPageNode;
a=a.parentWidget||a.parentGrid}return null},getParentReportContainerGrid:function(a){if(a instanceof u)return a;for(;a;){if(a.parentWidget instanceof u)return a.parentWidget;if(a.parentElementInPageInfo)return a.parentElementInPageInfo.reportContainer;a=a.parentWidget||a.parentGrid}return null},getParentReportPlayer:function(a){if(a instanceof x)return a;for(;a;){if(a.parentWidget instanceof x)return a.parentWidget;a=a.parentWidget||a.parentGrid}return null},getNodePositionOnPage:function(a,d){if(!d)return null;
var h,f=-1,e,c,m,k;a.getGrids().some(function(a,l){if(a.domNode===d||t.isChildOf(d,a.domNode))return h=a,e=l,a.getFieldCells().some(function(a,c){if(a.domNode===d||t.isChildOf(d,a.domNode))return f=c,k=a,!0}),-1===f&&a.getBackgroundFloatingCells().some(function(a,e){if(a.domNode===d||t.isChildOf(d,a.domNode))return f=e,c=!0,k=a,!0}),-1===f&&a.getForegroundFloatingCells().some(function(a,c){if(a.domNode===d||t.isChildOf(d,a.domNode))return f=c,m=!0,k=a,!0}),!0});if(!h)return null;a=a.getGridContainer(h);
var l=r.position(a),q=r.position(d);return{x:q.x-l.x,y:q.y-l.y,pageGrid:h,gridContainer:a,pageIndex:e,layoutCell:k,isFloatingPanel:c||m,isBackgroundFloatingPanel:c,isForegroundFloatingPanel:m,panelIndex:f}}};return v});